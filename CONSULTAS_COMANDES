--1--
CREATE OR REPLACE PROCEDURE CONSULTA_COMANDA_CODI (CODI_VENDEDOR NUMBER)
AS

RESULTADO ORDER2%ROWTYPE;

BEGIN

    SELECT * INTO RESULTADO FROM ORDER2 O
    WHERE O.SUPPLIER_CODE = CODI_VENDEDOR;
    
    DBMS_OUTPUT.PUT_LINE('CODIGO COMANDA: '||RESULTADO.ORDER_CODE||' FECHA COMANDA: '||RESULTADO.ORDER_DATE||' CODIGO CLIENTE: '||RESULTADO.CUSTOMER_CODE||' CODIGO VENDEDOR: '||RESULTADO.SUPPLIER_CODE||' CODIGO PRODUCTO: '||RESULTADO.PRODUCT_CODE||' CANTIDAD: '||RESULTADO.QUANTITY||' CANTIDAD TOTAL: '||RESULTADO.TOTAL_AMOUNT||' ELMINACION DE COMANDA: '||RESULTADO.ORDER_DROP);
    
END;


--LLAMAR A LA CONSULTA--
--SET SERVEROUTPUT ON;
--
--DECLARE
--
--    CODI_VENDEDOR NUMBER := &CODIVEN;
--    
--BEGIN
--
--    CONSULTA_COMANDA_CODI(CODI_VENDEDOR);
--    
--END;
    
--2--

CREATE OR REPLACE PROCEDURE CONSULTA_COMANDES
AS

IVA NUMBER;

CURSOR COMANDA IS
SELECT * FROM ORDER2 
ORDER BY ORDER_CODE;

BEGIN
    FOR I IN COMANDA LOOP
        IVA := I.TOTAL_AMOUNT * 1.16;
        DBMS_OUTPUT.PUT_LINE('CODIGO COMANDA: '||I.ORDER_CODE||' FECHA COMANDA: '||I.ORDER_DATE||' CODIGO CLIENTE: '||I.CUSTOMER_CODE||' CODIGO VENDEDOR: '||I.SUPPLIER_CODE||' CODIGO PRODUCTO: '||I.PRODUCT_CODE||' CATNTIDAD: '||I.QUANTITY||' CANTIDAD TOTAL: '||I.TOTAL_AMOUNT|| ' ELIMINACION COMANDA: '||I.ORDER_DROP);
    END LOOP;  
END;

--LLAMAR AL PROCEDIMIENTO--
--SET SERVEROUTPUT ON;
--
--BEGIN
--
--CONSULTA_COMANDES;
--
--END;

--3--
CREATE OR REPLACE PROCEDURE CONSULTA_COMANDA_DATA (FECHA DATE)
AS

CURSOR COMANDA IS
SELECT * FROM ORDER2
WHERE FECHA = ORDER_DATE;

BEGIN
    FOR I IN COMANDA LOOP
        DBMS_OUTPUT.PUT_LINE('CODIGO COMANDA: '||I.ORDER_CODE||' FECHA COMANDA: '||I.ORDER_DATE||' CODIGO CLIENTE: '||I.CUSTOMER_CODE||' CODIGO VENDEDOR: '||I.SUPPLIER_CODE||' CODIGO PRODUCTO: '||I.PRODUCT_CODE||' CATNTIDAD: '||I.QUANTITY||' CANTIDAD TOTAL: '||I.TOTAL_AMOUNT|| ' ELIMINACION COMANDA: '||I.ORDER_DROP);
    END LOOP;

END;


--LLAMAR AL PROCEDIMIENTO--
--SET SERVEROUTPUT ON;
--
--BEGIN
--
--CONSULTA_COMANDA_DATA('10/10/99');
--
--END;

--4--
CREATE OR REPLACE PROCEDURE CONSULTA_COMANDES_CLIENT (CODIGO_CLIENTE ORDER2.CUSTOMER_CODE%TYPE)
AS

CURSOR COMANDA IS
SELECT * FROM ORDER2
WHERE CODIGO_CLIENTE = CUSTOMER_CODE;

BEGIN
    FOR I IN COMANDA LOOP
        DBMS_OUTPUT.PUT_LINE('CODIGO COMANDA: '||I.ORDER_CODE||' FECHA COMANDA: '||I.ORDER_DATE||' CODIGO CLIENTE: '||I.CUSTOMER_CODE||' CODIGO VENDEDOR: '||I.SUPPLIER_CODE||' CODIGO PRODUCTO: '||I.PRODUCT_CODE||' CATNTIDAD: '||I.QUANTITY||' CANTIDAD TOTAL: '||I.TOTAL_AMOUNT|| ' ELIMINACION COMANDA: '||I.ORDER_DROP);
    END LOOP;
END;


--LLAMAR PROCEDIMIENTO--
--SET SERVEROUTPUT ON;
--
--BEGIN
--
--CONSULTA_COMANDES_CLIENT(12);
--END;

--5--
CREATE OR REPLACE PROCEDURE CONSULTA_COMANDES_VENEDOR (CODIGO_VENDEDOR ORDER2.SUPPLIER_CODE%TYPE)
AS

CURSOR COMANDA IS
SELECT * FROM ORDER2
WHERE CODIGO_VENDEDOR = SUPPLIER_CODE;

BEGIN
    FOR I IN COMANDA LOOP
        DBMS_OUTPUT.PUT_LINE('CODIGO COMANDA: '||I.ORDER_CODE||' FECHA COMANDA: '||I.ORDER_DATE||' CODIGO CLIENTE: '||I.CUSTOMER_CODE||' CODIGO VENDEDOR: '||I.SUPPLIER_CODE||' CODIGO PRODUCTO: '||I.PRODUCT_CODE||' CATNTIDAD: '||I.QUANTITY||' CANTIDAD TOTAL: '||I.TOTAL_AMOUNT|| ' ELIMINACION COMANDA: '||I.ORDER_DROP);
    END LOOP;
END;


--LLAMAR PROCEDIMIENTO--
--SET SERVEROUTPUT ON;
--
--BEGIN
--
--CONSULTA_COMANDES_VENEDOR(10);
--END;

--6--
CREATE OR REPLACE PROCEDURE CONSULTA_COMANDES_PRODUCTE (CODIGO_PRODUCTO ORDER2.PRODUCT_CODE%TYPE)
AS

CURSOR COMANDA IS
SELECT * FROM ORDER2
WHERE CODIGO_PRODUCTO = PRODUCT_CODE;

BEGIN
    FOR I IN COMANDA LOOP
        DBMS_OUTPUT.PUT_LINE('CODIGO COMANDA: '||I.ORDER_CODE||' FECHA COMANDA: '||I.ORDER_DATE||' CODIGO CLIENTE: '||I.CUSTOMER_CODE||' CODIGO VENDEDOR: '||I.SUPPLIER_CODE||' CODIGO PRODUCTO: '||I.PRODUCT_CODE||' CATNTIDAD: '||I.QUANTITY||' CANTIDAD TOTAL: '||I.TOTAL_AMOUNT|| ' ELIMINACION COMANDA: '||I.ORDER_DROP);
    END LOOP;
END;


--LLAMAR PROCEDIMIENTO--
--SET SERVEROUTPUT ON;
--
--BEGIN
--
--CONSULTA_COMANDES_PRODUCTE('A0001');
--END;
